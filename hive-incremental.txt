SELECT A.ACCOUNT_KEY,
A.ACCOUNT_BUSINESS_KEY,
A.ACCOUNT_NUMBER,
A.ACCOUNT_TITLE,
A.ACCOUNT_TYPE,
A.ACCOUNT_AUM_RANGE,
A.BROKER_DEALER_BUSINESS_KEY,
A.CREATE_DATE,
A.MODIFIED_DATE,
from_unixtime(unix_timestamp()-1*60*60*24, 'yyyyMMdd') AS INSERT_LOAD_TS,
'' AS LOAD_USR,
null AS LST_UPDATE_TS,
'' AS LST_UPDATE_USR
FROM pentameter.ACCOUNT A LEFT JOIN pentameter.ACCOUNT B
ON A.ACCOUNT_KEY = B.ACCOUNT_KEY
WHERE B.ACCOUNT_KEY IS NULL
UNION ALL
SELECT
A.ACCOUNT_KEY,
A.ACCOUNT_BUSINESS_KEY,
A.ACCOUNT_NUMBER,
A.ACCOUNT_TITLE,
A.ACCOUNT_TYPE,
A.ACCOUNT_AUM_RANGE,
A.BROKER_DEALER_BUSINESS_KEY,
A.CREATE_DATE,
A.MODIFIED_DATE,
NULL INSERT_LOAD_TS,
'' AS LOAD_USR,
from_unixtime(unix_timestamp()-1*60*60*24, 'yyyyMMdd') AS LST_UPDATE_TS,
'' AS LST_UPDATE_USR
FROM pentameter.ACCOUNT A LEFT JOIN pentameter.ACCOUNT B
ON A.ACCOUNT_KEY = B.ACCOUNT_KEY
WHERE CONCAT(A.ACCOUNT_BUSINESS_KEY,'|',A.ACCOUNT_NUMBER,'|',A.ACCOUNT_TITLE,'|',A.ACCOUNT_TYPE,'|',A.ACCOUNT_AUM_RANGE,'|',A.BROKER_DEALER_BUSINESS_KEY,'|',A.CREATE_DATE,'|',A.MODIFIED_DATE) <> CONCAT(B.ACCOUNT_BUSINESS_KEY,'|',B.ACCOUNT_NUMBER,'|',B.ACCOUNT_TITLE,'|',B.ACCOUNT_TYPE,'|',B.ACCOUNT_AUM_RANGE,'|',B.BROKER_DEALER_BUSINESS_KEY,'|',B.CREATE_DATE,'|',B.MODIFIED_DATE)
