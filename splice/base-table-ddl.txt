CREATE EXTERNAL TABLE IF NOT EXISTS BONUS.EXT_TRADES
STORED AS AVRO
LOCATION '/data/FLZ/import/sqoop/LREG/xyz12/'
TBLPROPERTIES ('avro.schema.url'='/user/kumarsu/part-m-00000.avsc');

CREATE TABLE IF NOT EXISTS BONUS.OPT_TRADES(
TRADE_ID STRING,
BD STRING,
BATCH_ID STRING,
SUPER_BATCH_ID STRING,
CLIENT_ID STRING,
ACCT_ID STRING,
SPON_CODE STRING,
SPONSOR_ACCT_NUMBER STRING,
PROD_SPON_CODE STRING,
PRODUCT_NUMBER STRING,
ACTUAL_CUSIP STRING,
PRODUCT_NAME STRING,
PRODUCT_SHORT_NAME STRING,
CONFIRM_NUMBER STRING,
TRADE_DATE STRING,
CANCEL_DATE STRING,
RECEIVE_DATE STRING,
SETTLEMENT_DATE STRING,
STATE_CODE STRING,
INVESTMENT_AMT STRING,
GDC_AMT STRING,
NET_CONCESSION_AMT STRING,
FEE_ID STRING,
FEE_AMT STRING,
FEE_EXEMPT_IND STRING,
INCOMING_FEE_AMT STRING,
UNITS STRING,
UNITS_PRICE STRING,
TRADE_SOURCE_IND STRING,
ELECTRONIC_TRADE_IND STRING,
NAV_IND STRING,
A12B1_IND STRING,
GDC_CREDIT_ONLY_IND STRING,
PRINCIPAL_IND STRING,
BUY_SELL_IND STRING,
HELD_IND STRING,
HELD_REASON STRING,
RDS_OVERRIDE_IND STRING,
SPLIT_IND STRING,
POST_DATE STRING,
POST_IND STRING,
RELATED_TRADE_ID STRING,
NOTES STRING,
CREATE_ID STRING,
CREATE_DATE STRING,
LAST_MOD_ID STRING,
LAST_MOD_DATE STRING,
SEC_TYPE STRING,
SEC_MOD STRING,
BLOTTER_CODE STRING,
MARKET_CODE STRING,
SS_CODE STRING,
FEE_CODE STRING,
FEE_OVERRIDE_IND STRING,
TOTAL_ORDER_UNITS STRING,
MANUAL_HELD_IND STRING,
TYPE_OF_ORDER STRING,
PROD_TYPE_CODE STRING,
TRAIL_FREQ_IND STRING,
HELD_REASON_CODE STRING,
MARKET_PRIMARY_IND STRING,
PRIMARY_EXCHANGE STRING,
PD_DATE STRING,
RNR STRING,
COMMISSIONBASISREASON STRING,
COMMISSIONBASISAMOUNT STRING,
COMMISSIONRATE STRING,
REC_NPK_HASH_VALUE BIGINT,
INSERT_LOAD_TS STRING,
LOAD_USR STRING,
LST_UPDATE_TS STRING,
LST_UPDATE_USR STRING,
LST_DELETE_TS STRING,
LST_DELETE_USR STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS PARQUET
TBLPROPERTIES ("auto.purge"="true");
